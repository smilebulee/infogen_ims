
{% load static %}

        <!-- TUI Calender -->
        <script src="https://uicdn.toast.com/tui.code-snippet/latest/tui-code-snippet.js"></script>
        <script src="https://uicdn.toast.com/tui.time-picker/v1.6.1/tui-time-picker.min.js"></script>
        <script src="https://uicdn.toast.com/tui.date-picker/v3.3.4/tui-date-picker.min.js"></script>
        <script src="https://uicdn.toast.com/tui-calendar/latest/tui-calendar.js"></script>

        <link rel="stylesheet" type="text/css" href="https://uicdn.toast.com/tui-calendar/latest/tui-calendar.css" />

        <script type="text/javascript" src="{% static 'diliCommon/diliCommon.js' %}"></script>

        <script type="text/javascript">
        $(document).ready(function(){
            $('#ipt_searchName').val(sessionStorage.getItem("email"))
            var tempStrtDt = "";
            var tempEndDt = "";

            var weekBtnClickChk = 1;
            var monthBtnClickChk = 0;

            $('#grp_grid').hide();                                                  // Calendar UI를 Default로 한다.
            $('#grp_showMonth').hide();                                             // Grid UI의 week를 Default로 한다.
            $('.grid-btnAction').css("display","none");


            //현재 날짜 가져오기
            var today = new Date();
            var year = today.getFullYear(); // 년도
            var month = today.getMonth();  // 월 (today.getMonth()는 0~11로 출력)
            var date = today.getDate();  // 날짜
            var day = today.getDay();  // 요일 (0~6으로 출력, 0:일요일, 1:월요일, 6:토요일)

            $('#txt_mmYy').text(year); //그리드 월tab 년도 초기값 입력
            $('#txt_mmMm').text(month + 1); //그리드 월tab 월 초기값 입력

            setMonthGridData();                                                                              // Month Grid 생성
            crteTodayShow(year, month, date, day);                                                        // Grid UI(주) 날짜 세팅
            //setAnhoMgmt(); //연차정보 입력
            createCalendar();     // Session Email


            /*********************************************************************
            *   weekGridDtDfr Btn Click Event - 주 그리드 날짜 이전 버튼 클릭
            *********************************************************************/
            $('#btn_weekGridDtDfr').click(function(){

                console.log("weekGridDtDfr Btn Click Event");

                var dfrWeekEndYy = $('#txt_weekEndYy').text(); //현재 종료 년도
                var dfrWeekEndMm = $('#txt_weekEndMm').text()-1; //현재 종료 월
                var dfrWeekEndDd = $('#txt_weekEndDd').text(); //현재 종료 일

                var dfrWeekStrtYy = $('#txt_weekStrtYy').text(); // 현재 시작 년도
                var dfrWeekStrtMm = $('#txt_weekStrtMm').text()-1; //현재 시작 월
                var dfrWeekStrtDd = $('#txt_weekStrtDd').text(); // 현재 시작 일

                var dfrEndDate = new Date(dfrWeekEndYy, dfrWeekEndMm, dfrWeekEndDd); //현재 종료 날짜 등록

                var dfrStrtDate = new Date(dfrWeekStrtYy, dfrWeekStrtMm, dfrWeekStrtDd); //현재 시작 날짜 등록

                dfrEndDate.setDate(dfrEndDate.getDate()-7); //종료 날짜 이전 주
                dfrStrtDate.setDate(dfrStrtDate.getDate()-7); //시작 날짜 이전 주

                $('#txt_weekEndYy').text(dfrEndDate.getFullYear());
                $('#txt_weekEndMm').text(dfrEndDate.getMonth()+1);
                $('#txt_weekEndDd').text(dfrEndDate.getDate());

                $('#txt_weekStrtYy').text(dfrStrtDate.getFullYear());
                $('#txt_weekStrtMm').text(dfrStrtDate.getMonth()+1);
                $('#txt_weekStrtDd').text(dfrStrtDate.getDate());

                tempStrtDt = setWeek(dfrStrtDate).baseDate;
                tempEndDt = setWeek(dfrEndDate).baseDate;
                setWeekGridData(tempStrtDt, tempEndDt);

                $('#txt_mmYy').text($('#txt_weekEndYy').text());
                $('#txt_mmMm').text($('#txt_weekEndMm').text());
                setMonthGridData();

                var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);

                calendar.clear();
                calendar.setDate(weekBtnNowDay);
                getCalendarSessionDate();
                setLabel(calendar);
            });

            /*********************************************************************
            *   weekGridDtNxt Btn Click Event - 주 그리드 날짜 이후 버튼 클릭
            *********************************************************************/
            $('#btn_weekGridDtNxt').click(function(){

                console.log("weekGridDtNxt Btn Click Event");

                var nxtWeekEndYy = $('#txt_weekEndYy').text(); //현재 종료 년도
                var nxtWeekEndMm = $('#txt_weekEndMm').text()-1; //현재 종료 월
                var nxtWeekEndDd = $('#txt_weekEndDd').text(); //현재 종료 일

                var nxtWeekStrtYy = $('#txt_weekStrtYy').text(); //현재 시작 년도
                var nxtWeekStrtMm = $('#txt_weekStrtMm').text()-1; //현재 시작 월
                var nxtWeekStrtDd = $('#txt_weekStrtDd').text(); //현재 시작 일

                nxtEndDate = new Date(nxtWeekEndYy, nxtWeekEndMm, nxtWeekEndDd); //종료 날짜 다음 주
                nxtStrtDate = new Date(nxtWeekStrtYy, nxtWeekStrtMm, nxtWeekStrtDd); //시작 날짜 다음 주

                nxtEndDate.setDate(nxtEndDate.getDate()+7);
                nxtStrtDate.setDate(nxtStrtDate.getDate()+7);

                $('#txt_weekEndYy').text(nxtEndDate.getFullYear());
                $('#txt_weekEndMm').text(nxtEndDate.getMonth()+1);
                $('#txt_weekEndDd').text(nxtEndDate.getDate());

                $('#txt_weekStrtYy').text(nxtStrtDate.getFullYear());
                $('#txt_weekStrtMm').text(nxtStrtDate.getMonth()+1);
                $('#txt_weekStrtDd').text(nxtStrtDate.getDate());

                tempStrtDt = setWeek(nxtStrtDate).baseDate;
                tempEndDt = setWeek(nxtEndDate).baseDate;
                setWeekGridData(tempStrtDt, tempEndDt);

                $('#txt_mmYy').text($('#txt_weekEndYy').text());
                $('#txt_mmMm').text($('#txt_weekEndMm').text());
                setMonthGridData();

                var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);

                calendar.clear();
                calendar.setDate(weekBtnNowDay);
                getCalendarSessionDate();
                setLabel(calendar);
            });

            /*********************************************************************
            *   mmGridDtDfr Btn Click Event - 월 그리드 날짜 이전 버튼 클릭
            *********************************************************************/
            $('#btn_mmGridDtDfr').click(function(){

                console.log("mmGridDtDfr Btn Click Event");

                var txt_mmYyDfr = $('#txt_mmYy').text();
                var txt_mmMmDfr = $('#txt_mmMm').text()-2;
                var showMmGridDtDfr = new Date(txt_mmYyDfr, txt_mmMmDfr, 1); //날짜 이전 값 등록

                $('#txt_mmYy').text(showMmGridDtDfr.getFullYear()); //그리드 월tab 년도 이전 값 입력
                $('#txt_mmMm').text(showMmGridDtDfr.getMonth() + 1); //그리드 월tab 월 이전 값 입력

                setMonthGridData();

                var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);
                var weekBtnYear = weekBtnNowDay.getFullYear();
                var weekBtnMonth = weekBtnNowDay.getMonth();
                var weekBtnDate = weekBtnNowDay.getDate();
                var weekBtnDay = weekBtnNowDay.getDay();

                crteTodayShow(weekBtnYear, weekBtnMonth, weekBtnDate, weekBtnDay);

                calendar.clear();
                calendar.setDate(weekBtnNowDay);
                getCalendarSessionDate();
                setLabel(calendar);

            });

            /*********************************************************************
            *   mmGridDtNxt Btn Click Event - 월 그리드 날짜 이후 버튼 클릭
            *********************************************************************/
            $('#btn_mmGridDtNxt').click(function(){

                console.log("mmGridDtNxt Btn Click Event");

                var txt_mmYyDfr = $('#txt_mmYy').text();
                var txt_mmMmDfr = $('#txt_mmMm').text();
                var showMmGridDtDfr = new Date(txt_mmYyDfr, txt_mmMmDfr, 1); //날짜 이후 값 등록

                $('#txt_mmYy').text(showMmGridDtDfr.getFullYear()); //그리드 월tab 년도 이후 값 입력
                $('#txt_mmMm').text(showMmGridDtDfr.getMonth() + 1); //그리드 월tab 월 이후 값 입력

                setMonthGridData();

                var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);
                var weekBtnYear = weekBtnNowDay.getFullYear();
                var weekBtnMonth = weekBtnNowDay.getMonth();
                var weekBtnDate = weekBtnNowDay.getDate();
                var weekBtnDay = weekBtnNowDay.getDay();

                crteTodayShow(weekBtnYear, weekBtnMonth, weekBtnDate, weekBtnDay);

                calendar.clear();
                calendar.setDate(weekBtnNowDay);
                getCalendarSessionDate();
                setLabel(calendar);

            });


            /*********************************************************************
            *   Grid Btn Click Event - 그리드 버튼 클릭
            *********************************************************************/
            $('#btn_showGrd').click(function(){

                console.log("Grid Btn Click Event");
                document.getElementById("btn_showGrd").style.backgroundColor = "lightgrey";
                document.getElementById("btn_showCal").style.backgroundColor = "";
                $('#grp_grid').show('');
                $('#grp_calendar').hide();
                $('.grid-btnAction').css("display","");
                $('.calendar-btnAction').css("display","none");

            });

            /*********************************************************************
            *   Calendar Btn Click Event - 캘린더 버튼 클릭
            *********************************************************************/
            $('#btn_showCal').click(function(){

                console.log("Calendar Btn Click Event");
                document.getElementById("btn_showCal").style.backgroundColor = "lightgrey";
                document.getElementById("btn_showGrd").style.backgroundColor = "";
                $('#grp_grid').hide();
                $('#grp_calendar').show('');
                $('.grid-btnAction').css("display","none");
                $('.calendar-btnAction').css("display","");

                var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);

                calendar.clear();
                calendar.setDate(weekBtnNowDay);
                getCalendarSessionDate();

                setLabel(calendar);
            });
            /*********************************************************************
            *   Week Btn Click Event - 주 버튼 클릭
            *********************************************************************/
            $('#btn_showWeek').click(function(){

                console.log("Week Btn Click Event");
                document.getElementById("btn_showWeek").style.backgroundColor = "#81DAF5";
                document.getElementById("btn_showWeek").style.color = "white";
                document.getElementById("btn_showMonth").style.backgroundColor = "white";
                document.getElementById("btn_showMonth").style.color = "#81DAF5";


                $('#grp_showWeek').show('');
                $('#grp_showMonth').hide();


                if(weekBtnClickChk == 0){

                    $('#monthBoody').children().css("background-color","");
                    var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);

                    var weekBtnYear = weekBtnNowDay.getFullYear();
                    var weekBtnMonth = weekBtnNowDay.getMonth();
                    var weekBtnDate = weekBtnNowDay.getDate();
                    var weekBtnDay = weekBtnNowDay.getDay();

                    crteTodayShow(weekBtnYear, weekBtnMonth, weekBtnDate, weekBtnDay);

                    calendar.clear();
                    calendar.setDate(weekBtnNowDay);
                    getCalendarSessionDate();
                    setLabel(calendar);
                }

                weekBtnClickChk = 1;
                monthBtnClickChk = 0;

            });

            /*********************************************************************
            *   Month Btn Click Event - 월 버튼 클릭
            *********************************************************************/
            $('#btn_showMonth').click(function(){

                console.log("Month Btn Click Event");
                document.getElementById("btn_showMonth").style.backgroundColor = "#81DAF5";
                document.getElementById("btn_showMonth").style.color = "white";
                document.getElementById("btn_showWeek").style.backgroundColor = "white";
                document.getElementById("btn_showWeek").style.color = "#81DAF5";

                $('#grp_showWeek').hide();
                $('#grp_showMonth').show('');

                if(monthBtnClickChk == 0){

                    $('#weekBoody').children().css("background-color","");
                    $('#txt_mmYy').text($('#txt_weekEndYy').text());
                    $('#txt_mmMm').text($('#txt_weekEndMm').text());
                    setMonthGridData();
                }

                weekBtnClickChk = 0;
                monthBtnClickChk = 1;
            });

            /*********************************************************************
            *   anhoReg Btn Click Event - 연차등록 버튼 클릭
            *********************************************************************/
            $('#btn_anhoReg').on('click', function() {

                modal('my_modal');                  //연차결제 화면 모달 띄우기
                $("#my_modal2").load("{% url 'dili_api:yryApvlReq' %}");


            });

            /*********************************************************************
            *   btn_datepicker Btn Click Event - 일달력호출
            *********************************************************************/
            $('#btn_datepicker').click(function(){

                 $('#datepickerData').datepicker('show');
            });

            /*********************************************************************
            *   클릭한 달력 datepickerData에 value 값 담기
            *********************************************************************/
            $("#datepickerData").datepicker({

                onSelect:function(dateText, inst) {

                    var tempData = $('#datepickerData').val().split('-');
                    var selectDatepickerDate = new Date(tempData[0], Number(tempData[1])-1, tempData[2]);

                    //날짜 세팅
                    year = selectDatepickerDate.getFullYear(); // 년도
                    month = selectDatepickerDate.getMonth();  // 월 (today.getMonth()는 0~11로 출력)
                    date = selectDatepickerDate.getDate();  // 날짜
                    day = selectDatepickerDate.getDay();  // 요일 (0~6으로 출력, 0:일요일, 1:월요일, 6:토요일)
                    crteTodayShow(year, month, date, day);

                    $('#txt_mmYy').text($('#txt_weekEndYy').text());
                    $('#txt_mmMm').text($('#txt_weekEndMm').text());
                    setMonthGridData();

                    var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);

                    calendar.clear();
                    calendar.setDate(weekBtnNowDay);
                    getCalendarSessionDate();
                    setLabel(calendar);
                }
	        });

	        /*********************************************************************
            *   btn_monthpicker Btn Click Event - 월달력호출
            *********************************************************************/
            $('#btn_monthpicker').bind('click', function(){

               $('#monthpickerData').monthpicker('show');
            });

            /*********************************************************************
            *   클릭한 달력monthpickerData에 value 값 담기
            *********************************************************************/
            $('#monthpickerData').monthpicker().bind('monthpicker-click-month', function (e, month) {

                var tempMonthpickerData = $('#monthpickerData').val().split('-');
                var selectMonthpickerData = new Date(tempMonthpickerData[0], Number(tempMonthpickerData[1])-1, 1);

                $('#txt_mmYy').text(selectMonthpickerData.getFullYear()); //그리드 월tab 년도 값 입력
                $('#txt_mmMm').text(selectMonthpickerData.getMonth() + 1); //그리드 월tab 월 값 입력
                setMonthGridData();

                var weekBtnNowDay = new Date($('#txt_mmYy').text(), Number($('#txt_mmMm').text())-1, 1);
                var weekBtnYear = weekBtnNowDay.getFullYear();
                var weekBtnMonth = weekBtnNowDay.getMonth();
                var weekBtnDate = weekBtnNowDay.getDate();
                var weekBtnDay = weekBtnNowDay.getDay();

                crteTodayShow(weekBtnYear, weekBtnMonth, weekBtnDate, weekBtnDay);

                calendar.clear();
                calendar.setDate(weekBtnNowDay);
                getCalendarSessionDate();
                setLabel(calendar);
            });

            /*********************************************************************
            *   my_modal 영역 닫기 버튼 클릭이벤트
            *********************************************************************/
            $('#exitSchdModal').click(function(){

                var dfrWeekEndYy = $('#txt_weekEndYy').text(); //현재 종료 년도
                var dfrWeekEndMm = $('#txt_weekEndMm').text()-1; //현재 종료 월
                var dfrWeekEndDd = $('#txt_weekEndDd').text(); //현재 종료 일

                var dfrWeekStrtYy = $('#txt_weekStrtYy').text(); // 현재 시작 년도
                var dfrWeekStrtMm = $('#txt_weekStrtMm').text()-1; //현재 시작 월
                var dfrWeekStrtDd = $('#txt_weekStrtDd').text(); // 현재 시작 일

                var dfrEndDate = new Date(dfrWeekEndYy, dfrWeekEndMm, dfrWeekEndDd); //현재 종료 날짜 등록
                var dfrStrtDate = new Date(dfrWeekStrtYy, dfrWeekStrtMm, dfrWeekStrtDd); //현재 시작 날짜 등록
                calendar.clear();
                var tempCalData = $('#calendarLabel').text().split('/');
                calendar.setDate(new Date(tempCalData[0],tempCalData[1]-1));

                getCalendarSessionDate();
                setLabel(calendar);

                tempStrtDt = setWeek(dfrStrtDate).baseDate;
                tempEndDt = setWeek(dfrEndDate).baseDate;
                setWeekGridData(tempStrtDt, tempEndDt);
                setMonthGridData();
                $('#my_modal2').empty();
                $('.model_layout').empty();

                //setAnhoMgmt();
                $('#clickDate').val("");
            });


            /*********************************************************************
            *   calendar 버튼제어 - today,이전날 다음달
            *********************************************************************/
            $("#today").click(function(){
              calendar.clear();
              calendar.today();
              getCalendarSessionDate();
              setLabel(calendar);
            });
            $("#prev").click(function(){
              calendar.clear();
              calendar.prev();
              getCalendarSessionDate();
              setLabel(calendar);
            });
            $("#next").click(function(){
              calendar.clear();
              calendar.next();
              getCalendarSessionDate();
              setLabel(calendar);
            });

        });/*ready.function_END*/

        var myChart;

        /*********************************************************************
        *   Session Email 값 기준 연차정보 조회
        *********************************************************************/
        function setAnhoMgmt(){
            var email = "";

            if ($('#empEmailHidden').val() == null || $('#empEmailHidden').val() == "") {
                email = sessionStorage.getItem("email");
            } else {
                email = $('#empEmailHidden').val();
            }

            var param = {
                "email" : email
            }

            $.ajaxCall( param, {

                 'method' : 'GET',
                 'url' : "{% url 'dili_api:getYryMgmt' %}",
                 'dataType' : 'json',
                 'data' : JSON.stringify(param),
                 'async' : false,
                 'callbackFn' : function(data){
                    if(data.length > 0){
                        $('#txt_allAnhoDays').text(data[0].ALL_YRY_DAYS) //전체연차일수
                        $('#txt_rmnAnhoDays').text(data[0].ALL_YRY_DAYS - data[0].USE_YRY_DAYS) //남은연차일수

                    }else {

                        $('#txt_allAnhoDays').text(0) //전체연차일수
                        $('#txt_rmnAnhoDays').text(0) //남은연차일수
                    }
                 }
            });
        }

        /*********************************************************************
        *   Session Email , StrtDt, endDt 값 기준 주 그리드 데이터 세팅
        *********************************************************************/
        function setWeekGridData(tempStrtDt, tempEndDt){
            var email = "";

            if ($('#empEmailHidden').val() == null || $('#empEmailHidden').val() == "") {
                email = sessionStorage.getItem("email");
            } else {
                email = $('#empEmailHidden').val();
            }



            var gridParam = {
                "email"     : email,
                "strtDt" : dateConverting1(tempStrtDt),
                "endDt" : dateConverting1(tempEndDt)
            }

            $.ajaxCall( gridParam, {
                 'method' : 'GET',
                 'url' : "{% url 'dili_api:getWeekGridData' %}",
                 'dataType' : 'json',
                 'data' : JSON.stringify(gridParam),
                 'async' : false,
                 'callbackFn' : function(data, status, xhr){
                    crteWeekGrid(data);
                 }
            });
        }

        /*********************************************************************
        *   Grid UI(주) 날짜 세팅
        *********************************************************************/
        function crteTodayShow(year, month, date, day){
            var strtDate = null;
            var endDate = null;

            //주tab 시작일, 종료일 입력 날짜 계산
            for(var i = 0; i < 7; i++ ){

                if(day == i){

                    strtDate = new Date(year, Number(month), Number(date) - i);
                    endDate = new Date(year, Number(month), Number(date) + 6 - i);
                }
            }

            $('#txt_weekStrtYy').text(strtDate.getFullYear()); //그리드 주tab 시작년도 입력
            $('#txt_weekStrtMm').text(strtDate.getMonth() + 1); //그리드 주tab 시작월 입력
            $('#txt_weekStrtDd').text(strtDate.getDate()); //그리드 주tab 시작일 입력

            $('#txt_weekEndYy').text(endDate.getFullYear()); //그리드 주tab 종료년도 입력
            $('#txt_weekEndMm').text(endDate.getMonth() + 1); //그리드 주tab 종료월 입력
            $('#txt_weekEndDd').text(endDate.getDate()); //그리드 주tab 종료일 입력

            tempStrtDt = setWeek(strtDate).baseDate;
            tempEndDt = setWeek(endDate).baseDate;
            setWeekGridData(tempStrtDt, tempEndDt);
        }

        /*********************************************************************
        *   Session Email , StrtDt, endDt 값 기준 월 그리드 데이터 세팅
        *********************************************************************/
        function setMonthGridData(){
            var email = "";

            if ($('#empEmailHidden').val() == null || $('#empEmailHidden').val() == "") {
                email = sessionStorage.getItem("email");
            } else {
                email = $('#empEmailHidden').val();
            }
            var monthChk;
            if($('#txt_mmMm').text().length == 1){
                monthChk = "0"+$('#txt_mmMm').text()
            } else {
                monthChk = $('#txt_mmMm').text()
            }
            var setMDt = $('#txt_mmYy').text() + "-" + monthChk
            var gridParam = {
                "email"     : email,
                "mDt" : setMDt
            }

            $.ajaxCall( gridParam, {
                 'method' : 'GET',
                 'url' : "{% url 'dili_api:getMonthGridData' %}",
                 'dataType' : 'json',
                 'data' : JSON.stringify(gridParam),
                 'async' : false,
                 'callbackFn' : function(data, status, xhr){
                    crteMonthGrid(data);
                 }
            });

        }

        function getDayLabel(day) {
            var week = new Array('일요일', '월요일', '화요일', '수요일', '목요일', '금요일', '토요일');
            var today = day;
            var todayLabel = week[today];
            return todayLabel;
        }

        /*********************************************************************
        *   Week Grid 생성
        *********************************************************************/
        function crteWeekGrid(schdData){

            var weekTable = '<table class="table table-bordered text-center">';
            weekTable += '<thead>';
            weekTable += '<tr>';
            weekTable += '<th class="text-center">일자</th>';
            weekTable += '<th class="text-center">시작시간</th>';
            weekTable += '<th class="text-center">종료시간</th>';
            weekTable += '<th class="text-center">휴게시간(분)</th>';
            weekTable += '<th class="text-center">총근무시간</th>';
            weekTable += '<th class="text-center">근무시간상세</th>';
            weekTable += '<th class="text-center">결재상태</th>';
            weekTable += '</tr>';
            weekTable += '</thead>';
            weekTable += '<tbody id="weekBoody">';

            var weekGridStrtYy = $('#txt_weekStrtYy').text(); //현재 시작 년도
            var weekGridStrtMm = $('#txt_weekStrtMm').text()-1; //현재 시작 월
            var weekGridStrtDd = $('#txt_weekStrtDd').text(); //현재 시작 일

            var weekGridStrtDate = new Date(weekGridStrtYy, weekGridStrtMm, weekGridStrtDd); //시작 날짜
            var tdDate = "";
            var tempSetWeek = "";
            var sumRestTm = 0;
            var tmpSumTotalWkrTm = 0;
            for(var i = 0; i < 7; i++){

                tdDate = weekGridStrtDate.getDate();
                tempSetWeek = dateConverting1(setWeek(weekGridStrtDate).baseDate);
                console.log("ㅋㅋㅋ weekGridStrtDate : "+weekGridStrtDate);

                var jobStrtTm = "-";
                var jobEndTm = "-";
                var allWrkTm = "-";
                var normWrkTm = "-";
                var overWrkTm = "-";
                var apvlStus = "-"
                var chckHldy = 0;
                var restTm = 0;
                var dinnRestTm = 0;
                var totalRestTm = 0;
                var ptoKdCd = ""; //휴가구분 01 연차 02 반차

                if(schdData.length > 0){
                    for(var j = 0; j < schdData.length; j++){
                        if(tempSetWeek == schdData[j].WRK_DT){
                            if(schdData[j].APVL_REQ_DIVS != "03"){

                                jobStrtTm = schdData[j].JOB_STRT_TM;
                                jobEndTm = schdData[j].JOB_END_TM;
                                if(schdData[j].ALL_WRK_TM != "00:00"){

									allWrkTm = schdData[j].ALL_WRK_TM;
								}

								if(schdData[j].NORM_WRK_TM != "00:00"){

									normWrkTm = schdData[j].NORM_WRK_TM;
								}

                                if(schdData[j].OVER_WRK_TM != "00:00"){

                                    overWrkTm = schdData[j].OVER_WRK_TM;
                                }

                            }else {
                                chckHldy = 1;
                                ptoKdCd = schdData[j].PTO_KD_CD;

                                if(ptoKdCd == "02"){
                                    jobStrtTm = schdData[j].JOB_STRT_TM;
                                    jobEndTm = schdData[j].JOB_END_TM;
                                    if(schdData[j].ALL_WRK_TM != "00:00"){
                                        allWrkTm = schdData[j].ALL_WRK_TM;
                                    }
                                    if(schdData[j].NORM_WRK_TM != "00:00"){
                                        normWrkTm = schdData[j].NORM_WRK_TM;
                                    }
                                    if(schdData[j].OVER_WRK_TM != "00:00"){
                                        overWrkTm = schdData[j].OVER_WRK_TM;
                                    }
                                }
                            }

                            if(schdData[j].APVL_REQ_DT == "N/A" && schdData[j].APVL_LAST_APRV_DT == "N/A" && schdData[j].OVER_WRK_TM != "00:00"){
                                apvlStus = "미등록"
                            }
                            if(schdData[j].TH1_APRV_STUS == "01"){
                                apvlStus = "진행중"
                            }
                            if(schdData[j].TH1_APRV_STUS == "02"){
                                apvlStus = "완료"
                            }
                            if(schdData[j].TH1_APRV_STUS == "03"){
                                apvlStus = "반려"
                            }

                            restTm = schdData[j].REST_TM;
                            dinnRestTm = schdData[j].DINN_REST_TM;
                        }
                    }
                }

                if(allWrkTm > 60) {
                    totalRestTm = Number(restTm) + Number(dinnRestTm) + 60;
                } else {
                    totalRestTm = Number(restTm) + Number(dinnRestTm);
                }

                sumRestTm += totalRestTm;
                if(allWrkTm != '-') {
                    var tmpTm = Number(allWrkTm.substr(0,2) * 60 ) + Number(allWrkTm.substr(3,6));
                    tmpSumTotalWkrTm += Number(tmpTm);
                }

                var hour = Math.floor(tmpSumTotalWkrTm/60);
                var minute = Math.floor(tmpSumTotalWkrTm%60);
                var sumTotalWkrTm = lpad((hour).toString(),2,"0")+":"+lpad((minute).toString(),2,"0");

                weekTable += '<tr id ="grd_week'+tempSetWeek+'" onclick="onclickWeekEvt(this)">';
                weekTable += '<td class="pt-3-half" contenteditable="false">'+tdDate+' ('+getDayLabel(weekGridStrtDate.getDay())+')'+'</td>';
                weekTable += '<td class="pt-3-half" contenteditable="false">'+jobStrtTm+'</td>';
                weekTable += '<td class="pt-3-half" contenteditable="false">'+jobEndTm+'</td>';
                weekTable += '<td class="pt-3-half" contenteditable="false">'+totalRestTm+'</td>';
                weekTable += '<td class="pt-3-half" contenteditable="false">'+allWrkTm+'</td>';

                if(chckHldy == 0){

                    weekTable += '<td class="pt-3-half" contenteditable="false">정상근무 : '+normWrkTm+' / 초과근무 : '+overWrkTm+'</td>';
                }else {
                    if(ptoKdCd == "01"){
                        weekTable += '<td class="pt-3-half" contenteditable="false">연차휴가</td>';
                    }else if(ptoKdCd == "02"){
                        weekTable += '<td class="pt-3-half" contenteditable="false">반차휴가</td>';
                    }else{
                        weekTable += '<td class="pt-3-half" contenteditable="false">오류발생 담당자확인요청필요</td>';
                    }

                }

                weekTable += '<td class="pt-3-half" contenteditable="false">'+apvlStus+'</td>';
                weekTable += '</tr>';
                weekGridStrtDate.setDate(weekGridStrtDate.getDate()+1);
            }


            weekTable += '<tr><td>합계</td>';
            weekTable += '<td>-</td>';
            weekTable += '<td>-</td>';
            weekTable += '<td>'+sumRestTm+'</td>';
            weekTable += '<td>'+ sumTotalWkrTm +'</td>';
            weekTable += '<td>-</td>';
            weekTable += '<td>-</td></tr>';
            weekTable += '</tbody>';
            weekTable += '</table>';

            document.getElementById('grid_week').innerHTML = weekTable;
            weekClickCrteGrap();
        }

        /*********************************************************************
        *   Month Grid 생성
        *********************************************************************/
        function crteMonthGrid(schdData){

            var monthTable = '<table class="table table-bordered text-center">';
            monthTable += '<thead>';
            monthTable += '<tr>';
            monthTable += '<th class="text-center">일자</th>';
            monthTable += '<th class="text-center">시작시간</th>';
            monthTable += '<th class="text-center">종료시간</th>';
            monthTable += '<th class="text-center">휴게시간(분)</th>';
            monthTable += '<th class="text-center">총근무시간</th>';
            monthTable += '<th class="text-center">근무시간상세</th>';
            monthTable += '<th class="text-center">결재상태</th>';
            monthTable += '</tr>';
            monthTable += '</thead>';
            monthTable += '<tbody id="monthBoody">';

            var monthGridStrtYy = $('#txt_mmYy').text(); //현재 시작 년도
            var monthGridStrtMm = $('#txt_mmMm').text()-1; //현재 시작 월

            var monthGridStrtDate = new Date(monthGridStrtYy, monthGridStrtMm, 1); //시작 날짜
            var tempMonthEndDate = new Date(monthGridStrtYy, monthGridStrtMm, 32); //다음 년도,월 세팅
            var monthEndDate = new Date(tempMonthEndDate.getFullYear(), tempMonthEndDate.getMonth(), 0); //종료 날짜
            var mTdDate = "";
            var tempSetMonth = "";
            var sumRestTm = 0;
            var tmpSumTotalWkrTm = 0;

            for(var i = 0; i < monthEndDate.getDate(); i++){

                mTdDate = monthGridStrtDate.getDate();
                tempSetMonth = dateConverting1(setWeek(monthGridStrtDate).baseDate);
				var jobStrtTm = "-";
                var jobEndTm = "-";
                var allWrkTm = "-";
                var normWrkTm = "-";
                var overWrkTm = "-";
                var apvlStus = "-"
                var chckHldy = 0;
                var restTm = 0;
                var dinnRestTm = 0;
                var totalRestTm = 0;
                var ptoKdCd = ""; //휴가구분 01 연차 02 반차

				if(schdData.length > 0){
                    for(var j = 0; j < schdData.length; j++){
                        if(tempSetMonth == schdData[j].WRK_DT){

                            if(schdData[j].APVL_REQ_DIVS != "03"){

                                jobStrtTm = schdData[j].JOB_STRT_TM;
                                jobEndTm = schdData[j].JOB_END_TM;

                                if(schdData[j].ALL_WRK_TM != "00:00"){

									allWrkTm = schdData[j].ALL_WRK_TM;
								}

								if(schdData[j].NORM_WRK_TM != "00:00"){

									normWrkTm = schdData[j].NORM_WRK_TM;
								}

                                if(schdData[j].OVER_WRK_TM != "00:00"){

                                    overWrkTm = schdData[j].OVER_WRK_TM;
                                }


                            }else {
                                chckHldy = 1;
                                ptoKdCd = schdData[j].PTO_KD_CD;

                                if(ptoKdCd == "02"){
                                    jobStrtTm = schdData[j].JOB_STRT_TM;
                                    jobEndTm = schdData[j].JOB_END_TM;
                                    if(schdData[j].ALL_WRK_TM != "00:00"){
                                        allWrkTm = schdData[j].ALL_WRK_TM;
                                    }
                                    if(schdData[j].NORM_WRK_TM != "00:00"){
                                        normWrkTm = schdData[j].NORM_WRK_TM;
                                    }
                                    if(schdData[j].OVER_WRK_TM != "00:00"){
                                        overWrkTm = schdData[j].OVER_WRK_TM;
                                    }
                                }
                            }

                            if(schdData[j].APVL_REQ_DT == "N/A" && schdData[j].APVL_LAST_APRV_DT == "N/A" && schdData[j].OVER_WRK_TM != "00:00"){
                                apvlStus = "미등록"
                            }
                            if(schdData[j].TH1_APRV_STUS == "01"){
                                apvlStus = "진행중"
                            }
                            if(schdData[j].TH1_APRV_STUS == "02"){
                                apvlStus = "완료"
                            }
                            if(schdData[j].TH1_APRV_STUS == "03"){
                                apvlStus = "반려"
                            }

                            restTm = schdData[j].REST_TM;
                            dinnRestTm = schdData[j].DINN_REST_TM;
                        }

                    }
                }

                if(allWrkTm > 60) {
                    totalRestTm = Number(restTm) + Number(dinnRestTm) + 60;
                } else {
                    totalRestTm = Number(restTm) + Number(dinnRestTm);
                }

                sumRestTm += totalRestTm;
                if(allWrkTm != '-') {
                    var tmpTm = Number(allWrkTm.substr(0,2) * 60 ) + Number(allWrkTm.substr(3,6));
                    tmpSumTotalWkrTm += Number(tmpTm);
                }

                var hour = Math.floor(tmpSumTotalWkrTm/60);
                var minute = Math.floor(tmpSumTotalWkrTm%60);
                var sumTotalWkrTm = lpad((hour).toString(),2,"0")+":"+lpad((minute).toString(),2,"0");

                monthTable += '<tr id ="grd_month'+tempSetMonth+'" onclick="onclickMonthEvt(this)">';
                monthTable += '<td class="pt-3-half" contenteditable="false">'+mTdDate+'</td>';
                monthTable += '<td class="pt-3-half" contenteditable="false">'+jobStrtTm+'</td>';
                monthTable += '<td class="pt-3-half" contenteditable="false">'+jobEndTm+'</td>';
                monthTable += '<td class="pt-3-half" contenteditable="false">'+totalRestTm+'</td>';
                monthTable += '<td class="pt-3-half" contenteditable="false">'+allWrkTm+'</td>';

                if(chckHldy == 0){

                    monthTable += '<td class="pt-3-half" contenteditable="false">정상근무 : '+normWrkTm+' / 초과근무 : '+overWrkTm+'</td>';
                }else {
                    if(ptoKdCd == "01"){
                        monthTable += '<td class="pt-3-half" contenteditable="false">연차휴가</td>';
                    }else if(ptoKdCd == "02"){
                        monthTable += '<td class="pt-3-half" contenteditable="false">반차휴가</td>';
                    }else{
                        monthTable += '<td class="pt-3-half" contenteditable="false">오류발생 담당자확인요청필요</td>';
                    }
                }

                monthTable += '<td class="pt-3-half" contenteditable="false">'+apvlStus+'</td>';
                monthTable += '</tr>';
                monthGridStrtDate.setDate(monthGridStrtDate.getDate()+1);
            }

            monthTable += '<tr><td>합계</td>';
            monthTable += '<td>-</td>';
            monthTable += '<td>-</td>';
            monthTable += '<td>'+sumRestTm+'</td>';
            monthTable += '<td>'+sumTotalWkrTm+'</td>';
            monthTable += '<td>-</td>';
            monthTable += '<td>-</td></tr>';

            monthTable += '</tbody>';
            monthTable += '</table>';

            document.getElementById('month_week').innerHTML = monthTable;
            monthClickCrteGrap();
        }

        /*********************************************************************
        *   onclickWeekEvt 날짜 가져오기
        *********************************************************************/
       function onclickWeekEvt(trId) {

            var wClickDt = trId.id.replace('grd_week','');

            //getWrkTimeByIml(null, weekDate.strtDate, weekDate.endDate);     // Session Email 을 기준으로 시작~종료일에 대한 근무시간 조회.
            $('#'+trId.id).prevAll().css("background-color","");
            $('#'+trId.id).nextAll().css("background-color","");
            $('#'+trId.id).css("background-color","#8A8C8F");

            if($('#clickDate').val() == wClickDt){
                modal('my_modal');
                $('#my_modal2').load("{% url 'dili_api:scheduleMgmtPop' %}");

                $('#tmpPopDt').text(trId.id.replace('grd_week',''));
                $('#tmpPopStrtTm').text($('#'+trId.id).children().eq(1).text());
                $('#tmpPopEndTm').text($('#'+trId.id).children().eq(2).text());

                //$('#tmpRestTm').text($('#'+trId.id).children().eq(3).text());
                //$('#tmpDinnRestTm').text($('#'+trId.id).children().eq(4).text());
                var detlSchd = $('#'+trId.id).children().eq(5).text();
                var normWrkTm = "-";
                var overWrkTm = "-";
                var holi = "-";
                var ptoKdCd = "";
                if(detlSchd != "연차휴가" && detlSchd != "반차휴가"){

                    normWrkTm = detlSchd.split('/')[0].replace('정상근무 : ','').trim();
                    overWrkTm = detlSchd.split('/')[1].replace('초과근무 : ','').trim();
                }else {
                    if(detlSchd=="연차휴가"){
                        ptoKdCd = "01";
                    }else if(detlSchd=="반차휴가"){
                        ptoKdCd = "02";
                    }
                    holi = detlSchd;
                }
                $('#tmpNormWrkTm').text(normWrkTm);
                $('#tmpOverWrkTm').text(overWrkTm);
                $('#tmpHoli').text(holi);
                $('#tmpPtoKdCd').text(ptoKdCd);
                $('#tmpPopAllTm').text($('#'+trId.id).children().eq(4).text());
                $('#tmpPopApvlStus').text($('#'+trId.id).children().eq(6).text());
            }
            $('#clickDate').val(wClickDt);


       }

       /*********************************************************************
        *   onclickMonthEvt 날짜 가져오기
        *********************************************************************/
       function onclickMonthEvt(trId) {

            var mClickDt = trId.id.replace('grd_month','');

            weekDate = setWeek(mClickDt);                                   // 선택된 일이 포함된 주의 Start,End Date 조회
            //getWrkTimeByIml(null, weekDate.strtDate, weekDate.endDate);     // Session Email 을 기준으로 시작~종료일에 대한 근무시간 조회.

            $('#'+trId.id).prevAll().css("background-color","");
            $('#'+trId.id).nextAll().css("background-color","");
            $('#'+trId.id).css("background-color","#8A8C8F");
            if($('#clickDate').val() == mClickDt){
                modal('my_modal');
                $('#my_modal2').load("{% url 'dili_api:scheduleMgmtPop' %}");

                $('#tmpPopDt').text(trId.id.replace('grd_month',''));
                $('#tmpPopStrtTm').text($('#'+trId.id).children().eq(1).text());
                $('#tmpPopEndTm').text($('#'+trId.id).children().eq(2).text());
                //$('#tmpRestTm').text($('#'+trId.id).children().eq(3).text());
                //$('#tmpDinnRestTm').text($('#'+trId.id).children().eq(4).text());

                var detlSchd = $('#'+trId.id).children().eq(6).text();
                var normWrkTm = "-";
                var overWrkTm = "-";
                var holi = "-";
                if(detlSchd != "연차휴가" && detlSchd != "반차휴가"){

                    normWrkTm = detlSchd.split('/')[0].replace('정상근무 : ','').trim();
                    overWrkTm = detlSchd.split('/')[1].replace('초과근무 : ','').trim();
                }else {
                    if(detlSchd=="연차휴가"){
                        ptoKdCd = "01";
                    }else if(detlSchd=="반차휴가"){
                        ptoKdCd = "02";
                    }
                    holi = detlSchd;
                }
                $('#tmpNormWrkTm').text(normWrkTm);
                $('#tmpOverWrkTm').text(overWrkTm);
                $('#tmpHoli').text(holi);
                $('#tmpPopAllTm').text($('#'+trId.id).children().eq(5).text());
                $('#tmpPopApvlStus').text($('#'+trId.id).children().eq(7).text());
            }
            $('#clickDate').val(mClickDt);

       }

        /*********************************************************************
        *   Email 을 기준하여, start ~ end Date에 해당하는 직원의 근무시간을 조회한다.
        *   Input Parameter  - email            : 조회할 직원의 Email (Null or String / Null 인 경우 Session값을 기준으로 조회한다.)
        *                    - strtDate         : 조회할 시작 일      (String or Date - Format YYYY/MM/DD )
        *                    - endDate          : 조회할 마지막 일    (String or Date - Format YYYY/MM/DD )
        *   Output Parameter - nmlWrkTime       : 정상근무시간
        *                      aprvWrkTime      : 초과근무시간(승인)
        *                      notAprvWrkTime   : 초과근무시간(미승인)
        *********************************************************************/
       function getWrkTimeByIml(email, dt) {

            console.log(' Debug [Email] : '+email );
            console.log(' Debug [dt] : '+dt );

            //var baseEndDate = $('#baseEndDate').text();

            if(dt == $('#grapDt').val()){

                return;
            }

            $('#grapDt').val(dt);
            //email 파라미터가 null / EmptyString 으로 인입된 경우 $('#empEmailHidden') 값 또는, Session 값을 기준하여 셋팅.
            if (email == null || email == "") {

                if ($('#empEmailHidden').val() == null || $('#empEmailHidden').val() == "") {
                    email = sessionStorage.getItem("email");
                } else {
                    email = $('#empEmailHidden').val();
                }
            }

            var param = {
                "email"     : email,
                "dt"  : dt
            }

            var url = "{% url 'dili_api:getTotalWrktm' %}";
            submissionCallMap(param,'GET',url,getTotalWrktmSubMitDone);

            $.ajaxCall( param, {
                 'method' : 'GET',
                 'url' : "{% url 'dili_api:getWrkTimeInfoByEml' %}",
                 'dataType' : 'json',
                 'data' : JSON.stringify(param),
                 'async' : false,
                 'callbackFn' : function(data, status, xhr){
                    console.log("data : ",data)

                    //$('#baseEndDate').text(endDate);                  // endDate가 변경되는 경우만 Server Call하기 위해 변수셋팅.

                    if(data.length > 0) {
                        var normWrkTm = Number(data[0].NORM_WRK_TM);
                        var notAprvOverWrkTm = Number(data[0].NOT_APRV_OVER_WRK_TM);
                        var aprvOverWrkTm = Number(data[0].APRV_OVER_WRK_TM);
                        var acumWrkTm = normWrkTm + notAprvOverWrkTm + aprvOverWrkTm;
                        $('#acumWrkTm').text("나의 근무시간 = " + acumWrkTm.toFixed(2) + "H");
                    }
                 }
            });
       }

       function getTotalWrktmSubMitDone(data){

            $('#monthTotalWrkTm').val(data[0].WRK_TOT_TM);
            $('#testTxt').text(data[0].WRK_TOT_TM);

            var totalWrkTm;
            totalWrkTm = "나의 총 근무가능 시간 (기본 근무시간 + 연장근무 가능시간) = ";
            totalWrkTm += (Number(data[0].WRK_TOT_TM) + Number(data[0].EXTN_WRK_PSBL_TM)).toFixed(2) + "H";

            $('#totalTm').text(totalWrkTm);
       }


        var calendar;

        /*********************************************************************
        *   Draw  calendar Event - 캘린더 API 그리기
        *********************************************************************/
        function createCalendar(){
            if (calendar != "undefined" && calendar != null && calendar != "") {
                calendar.destroy();
            }

            calendar = new tui.Calendar(document.getElementById('calendar'), {
                defaultView: 'month',
                taskView: true,
                 /*
                 useCreationPopup: true,
                 useDetailPopup: true
                 */
            });

            calendar.on('afterRenderSchedule', function(event) {

                //현재 스케쥴ID와 스케쥴전체List  dataCustomArray의 마지막 항목과 ID값이 같다면, CalendarColor 호출.
                if(event.schedule.id == dataCustomArray[dataCustomArray.length-1].id) {
                    setCalendarColor();
                }
            });


            /*********************************************************************
            *  저장, 수정, 삭제 이벤트
            *********************************************************************/
            calendar.on("beforeCreateSchedule", function(scheduleData){
                /*작업중*/
                $('.tui-full-calendar-month-guide-block').remove();
                var schedule = {
                  calendarId: scheduleData.calendarId,
                  id: String(Math.random() * 100000000000000000),
                  title: scheduleData.title,
                  isAllDay: scheduleData.isAllDay,
                  start: scheduleData.start,
                  end: scheduleData.end,
                  category: scheduleData.isAllDay ? 'allday' : 'time',
                  location: scheduleData.location             // 장소 정보
                };


                console.log("asdsad"+schedule.end.getFullYear()+"-"+(schedule.end.getMonth()+1)+"-"+schedule.end.getDate());
                var tmp = schedule.end.getFullYear()+"/"+(schedule.end.getMonth()+1)+"/"+schedule.end.getDate();

                var tmpDtbase = setWeek(tmp).baseDate;
                weekDate = setWeek(tmp);                                   // 선택된 일이 포함된 주의 Start,End Date 조회
                //getWrkTimeByIml(null, weekDate.strtDate, weekDate.endDate);     // Session Email 을 기준으로 시작~종료일에 대한 근무시간 조회.

                var tempSrhClickData = tmpDtbase.split('/')
                var srhClickData = new Date(tempSrhClickData[0], Number(tempSrhClickData[1])-1, tempSrhClickData[2]);

                //날짜 세팅
                var srhClickYear = schedule.end.getFullYear(); // 년도
                var srhClickMonth = schedule.end.getMonth();  // 월 (today.getMonth()는 0~11로 출력)
                var srhClickDate = schedule.end.getDate();  // 날짜
                var srhClickDay = schedule.end.getDay();  // 요일 (0~6으로 출력, 0:일요일, 1:월요일, 6:토요일)
                crteTodayShow(srhClickYear, srhClickMonth, srhClickDate, srhClickDay);
                $('#btn_showGrd').trigger('click');
                $('#btn_showWeek').trigger('click');

                $('#txt_mmYy').text(tempSrhClickData[0]);
                $('#txt_mmMm').text(tempSrhClickData[1]);
                setMonthGridData();
            });

            setLabel(calendar);
            getCalendarSessionDate();


        }



        /*********************************************************************
        *   Draw  calendar Event - 데이터 받아오기
        *********************************************************************/
        function getCalendarSessionDate() {
            var email = "";
            console.log("캘런더 현재날짜 가져오기 : ",calendar.getDate().getFullYear() + "-" + (calendar.getDate().getMonth()+1));

            var monthChk = calendar.getDate().getMonth()+1;
            if(monthChk.toString().length == 1){
                monthChk = "0"+monthChk;
            }

            var dt = calendar.getDate().getFullYear() + "-" + monthChk;

            if ($('#empEmailHidden').val() == null || $('#empEmailHidden').val() == "") {
                email = sessionStorage.getItem("email");
            } else {
                email = $('#empEmailHidden').val();
            }

            var param = {
                "email"     : email,
                "dt"        : dt
            }

            $.ajaxCall( param, {
                 'method' : 'GET',
                 'url' : "{% url 'dili_api:getCalendarData' %}",
                 'dataType' : 'json',
                 'data' : JSON.stringify(param),
                 'async' : false,
                 'callbackFn' : function(data, status, xhr){
                    console.log("data111 : ",JSON.parse(data))
                    var dataParam = JSON.parse(data)

                    if(dataParam.length > 0) {
                        setCalendar(data);
                    }
                 }
            });
        }
        var dataCustomArray;
        /*********************************************************************
        *   Draw  calendar Event - 받아온 데이터 캘린더에 입력
        *********************************************************************/
        function setCalendar(data){
            console.log("setCalendar Start");
            console.log("calendarData1 : ",data);

            var calendarData = JSON.parse(data);

            dataCustomArray = new Array();
            for(var i=0; i < calendarData.length; i++) {
                var wrkDt  = calendarData[i].WRK_DT;
                var statTm  = calendarData[i].JOB_STRT_TM;
                var endTm  = calendarData[i].JOB_END_TM;

                var normTm  = calendarData[i].NORM_WRK_TM;
                var overTm  = calendarData[i].OVER_WRK_TM;
                var apvlReqDivs = calendarData[i].APVL_REQ_DIVS
                var statTmTitle = "시작시간: " + statTm;
                var endTmTitle = "종료시간: " + endTm;

                if(statTm == "-" && endTm == "-" && apvlReqDivs == "03"){
                    statTmTitle = "휴가";
                    statTm = "00:00"
                }

                var startTimeAdd = wrkDt + "T" + statTm;
                var endTimeAdd = wrkDt + "T" + endTm;


                var apvlStus = "";
                if(calendarData[i].APVL_REQ_DT == "N/A" && calendarData[i].APVL_LAST_APRV_DT == "N/A" && calendarData[i].OVER_WRK_TM != "00:00"){
                    apvlStus = "미등록"
                }
                if(calendarData[i].TH1_APRV_STUS == "01"){
                    apvlStus = "진행중"
                }
                if(calendarData[i].TH1_APRV_STUS == "02"){
                    apvlStus = "완료"
                }
                if(calendarData[i].TH1_APRV_STUS == "03"){
                    apvlStus = "반려"
                }
                var dataCustom;
                if(statTm != "-"){
                    dataCustom = {
                        calendarId: wrkDt+"/"+"start",
                        id: String(Math.random() * 100000000000000000),
                        title : statTmTitle,
                        isAllDay: false,
                        start: startTimeAdd,
                        end: startTimeAdd,
                        category: "time",
                        normTm: normTm,
                        overTm: overTm,
                        apvlStus: apvlStus,
                        apvlReqDivs : apvlReqDivs
                    };
                    dataCustomArray.push(dataCustom);
                }
                if(endTm != "-"){
                    dataCustom = {
                        calendarId: wrkDt+"/"+"end",
                        id: String(Math.random() * 100000000000000000),
                        title : endTmTitle,
                        isAllDay: false,
                        start: endTimeAdd,
                        end: endTimeAdd,
                        category: "time",
                        normTm: normTm,
                        overTm: overTm,
                        apvlStus: apvlStus,
                        apvlReqDivs : apvlReqDivs
                    };
                    dataCustomArray.push(dataCustom);
                }
            }

            console.log("dataCustomArray : ",dataCustomArray);

            calendar.createSchedules(dataCustomArray);
        }

        function setLabel(calendar){
          var dt;
          $("#calendarLabel").text(calendar.getDate().getFullYear() + "/" + (calendar.getDate().getMonth()+1));
          if((calendar.getDate().getMonth()+1).toString().length == 1){
              dt = calendar.getDate().getFullYear() + "-" + "0" + (calendar.getDate().getMonth()+1);
          } else {
              dt = calendar.getDate().getFullYear() + "-" + (calendar.getDate().getMonth()+1);
          }
          getWrkTimeByIml(null, dt);

        }
        /*********************************************************************
        *   Draw  calendar Event - 캘린더 색입히기
        *********************************************************************/
        function setCalendarColor(){
            for(var i=0; i < dataCustomArray.length; i++) {
                if(dataCustomArray[i].apvlStus == "완료"){
                    $('div[data-calendar-id="'+dataCustomArray[i].calendarId+'"]').css("background-color","rgba( 249,247,232, 1 )");
                }
            }
            for(var i=0; i < dataCustomArray.length; i++) {
                if(dataCustomArray[i].apvlStus == "미등록"){
                   $('div[data-calendar-id="'+dataCustomArray[i].calendarId+'"]').css("background-color","rgba( 255,139,139, 0.5 )");
                }
            }
            for(var i=0; i < dataCustomArray.length; i++) {
                if(dataCustomArray[i].apvlStus == "진행중"){
                   $('div[data-calendar-id="'+dataCustomArray[i].calendarId+'"]').css("background-color","rgba( 255,255,153, 0.5 )");
                }
            }
            for(var i=0; i < dataCustomArray.length; i++) {
                if(dataCustomArray[i].apvlStus == "반려"){
                   $('div[data-calendar-id="'+dataCustomArray[i].calendarId+'"]').css("background-color","rgba( 153,153,255, 0.5 )");
                }
            }

        }

        /*********************************************************************
        *   주그리드 그래프세팅
        *********************************************************************/
        function weekClickCrteGrap(){
            var dt;
            if($('#txt_weekEndMm').text().length == 1){
                dt = $('#txt_weekEndYy').text() + "-" + "0" + $('#txt_weekEndMm').text();
            } else {
                dt = $('#txt_weekEndYy').text() + "-" + $('#txt_weekEndMm').text();
            }
            getWrkTimeByIml(null, dt);
        }

        /*********************************************************************
        *   월그리드 그래프세팅
        *********************************************************************/
        function monthClickCrteGrap(){
            var dt;
            if($('#txt_mmMm').text().length == 1){
                dt = $('#txt_mmYy').text() + "-" + "0" + $('#txt_mmMm').text();
            } else {
                dt = $('#txt_mmYy').text() + "-" + $('#txt_mmMm').text();
            }
            getWrkTimeByIml(null, dt);
        }



        /*********************************************************************
        *  퇴근 UPDATE
        *********************************************************************/
        function onclickLvocPop() {
            var today = new Date();
            var tmp = today.getFullYear()+"/"+(today.getMonth()+1)+"/"+today.getDate();
            var tmpDtbase = setWeek(tmp).baseDate;
            weekDate = setWeek(tmp);                                   // 선택된 일이 포함된 주의 Start,End Date 조회

            var tempSrhClickData = tmpDtbase.split('/')
            var srhClickData = new Date(tempSrhClickData[0], Number(tempSrhClickData[1])-1, tempSrhClickData[2]);

            //날짜 세팅
            var srhClickYear = today.getFullYear(); // 년도
            var srhClickMonth = today.getMonth();  // 월 (today.getMonth()는 0~11로 출력)
            var srhClickDate = today.getDate();  // 날짜
            var srhClickDay = today.getDay();  // 요일 (0~6으로 출력, 0:일요일, 1:월요일, 6:토요일)
            crteTodayShow(srhClickYear, srhClickMonth, srhClickDate, srhClickDay);
            $('#btn_showGrd').trigger('click');
            $('#btn_showWeek').trigger('click');

            $('#txt_mmYy').text(tempSrhClickData[0]);
            $('#txt_mmMm').text(tempSrhClickData[1]);
            setMonthGridData();
            var dte = "grd_week" + dateConverting1(tmpDtbase);
            var dteJson = {id : dte};

            $('#clickDate').val(dateConverting1(tmpDtbase));
            onclickWeekEvt(dteJson);
        }

    </script>
        <input type="hidden" id="grapDt"/>
        <input type="hidden" id="monthTotalWrkTm"/>
        <input type="hidden" id="clickDate"/>
        <!--근무시간관리상세 모달 영역 -->
        <div id="my_modal" class="modalUi">
            <div id="my_modal2">
            </div>
            <a class="modal_close_btn" id="exitSchdModal">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                   <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                   <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                </svg>
                <span id="tmpPopDt" class="model_layout" style="display:none;" ></span>
                <span id="tmpPopStrtTm" class="model_layout" style="display:none;" ></span>
                <span id="tmpPopEndTm" class="model_layout" style="display:none;" ></span>
                <!--<span id="tmpRestTm" class="model_layout" style="display:none;" ></span>
                <span id="tmpDinnRestTm" class="model_layout" style="display:none;" ></span>-->

                <span id="tmpNormWrkTm" class="model_layout" style="display:none;" ></span>
                <span id="tmpOverWrkTm" class="model_layout" style="display:none;" ></span>
                <span id="tmpHoli" class="model_layout" style="display:none;" ></span>
                <span id="tmpPtoKdCd" class="model_layout" style="display:none;" ></span>

                <span id="tmpPopAllTm" class="model_layout" style="display:none;" ></span>
                <span id="tmpPopApvlStus" class="model_layout" style="display:none;" ></span>
            </a>
        </div>

        <!--결재올리기기 모달 영역 -->
        <div id="apvlUpldDiv_modal" class="modalUi">
            <div id="apvlUpld_modal">
            </div>
            <a class="modal_close_btn" id="exitApvlModalBtn">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                   <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                   <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                </svg>
            </a>
        </div>

        <!--직원조회 모달 영역 -->
        <div id="empModalDiv" class="modalUi">
            <div id="empModal">
            </div>
            <a class="modal_close_btn" id="exitEmpModalBtn">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                   <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                   <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                </svg>
                <span id="empEmailHidden" style="display:none;" ></span>
            </a>
        </div>

        <div class="row">
            <div class="col-sm-12">
                <div class="mb-4" role="alert">
                    <h5>
                        <b>근무시간관리</b>
                    </h5>
                </div>

                <!-- 1. 사원 조회영역 -->
                <div class="accordion mb-4" id="grp_search">
                    <div class="card">
                        <div class="card-header p-0" id="head_search">
                            <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left text-dark" type="button" data-toggle="collapse" data-target="#col_search" aria-expanded="true" aria-controls="collapseOne">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-caret-down-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                                    </svg>
                                    직원조회
                                </button>
                            </h2>
                        </div>
                        <div id="col_search" class="collapse show" aria-labelledby="head_search" data-parent="#grp_search">
                            <div class="card-body flex-height d-flex m-0 p-2">
                                <div class="align-self-start align-self-center mr-3">ID</div>
                                <div class="align-self-center mr-3">
                                    <input type="text" class="form-control" id="ipt_searchName" name="ipt_searchName"  maxlength="10" disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. 사원 누적근무시간 영역 -->
                <div class="accordion mb-4" id="grp_totWrkTime">
                    <div class="card">
                        <div class="card-header p-0" id="head_totWrkTime">
                            <h2 class="mb-0">
                                <button id="btn_acdTotWrkTime" class="btn btn-link btn-block text-left text-dark" type="button" data-toggle="collapse" data-target="#col_totWrkTime" aria-expanded="true" aria-controls="collapseOne">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-caret-down-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                                    </svg>
                                    누적근무시간
                                </button>
                            </h2>
                        </div>
                        <div id="col_totWrkTime" class="collapse show" aria-labelledby="head_totWrkTime" data-parent="#grp_totWrkTime">
                            <div class="mt-3" style="width:100%;">
                                <div class="chart-container" style="display:block; width:100%; height:80px;">
                                    <!--<span id="baseEndDate" style="display:none;" ></span>-->
                                    <center><span id="totalTm" style="font-weight:bold;"></span></center>
                                    <center><span id="acumWrkTm" style="font-weight:bold;"></span></center>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--<div class="d-flex flex-row-reverse mb-2">-->

                    <!-- 연차등록 버튼 -->
                    <!--<div>
                        <button type="button" class="btn btn-sm" style="background-color: #81DAF5; color : white;" id="btn_anhoReg">연차등록</button>
                    </div>-->
                    <!-- 전체연차일수/ 남은연차일수 표기 -->
                    <!--<div style="margin-right: 20px;">
                        <span>전체연차일수 : </span>
                        <span id="txt_allAnhoDays">0</span>
                        <span> / 남은연차일수 : </span>
                        <span id="txt_rmnAnhoDays">0</span>
                    </div>
                </div>-->


                <div class="d-flex flex-row-reverse mb-2">

                    <div id="btn_showGrd">
                        <img width="30px" height="30px"  src="{% static 'image/grid.png' %}" align="center">
                    </div>
                    <div id="btn_showCal" style="background-color: lightgrey;">
                        <img width="30px" height="30px"  src="{% static 'image/calendar.png' %}" align="center">
                    </div>
                    <div class="d-flex flex-row-reverse mr-2 grid-btnAction">
                        <button type="button" class="btn grid-btnAction" id="btn_showMonth" style="background-color: white; width : 35px; height : 30px; font-size : 12px; color : #81DAF5; font-weight:bold;">월</button>
                        <button type="button" class="btn grid-btnAction" id="btn_showWeek" style="background-color: #81DAF5; width : 35px; height : 30px; font-size : 12px; color : white; font-weight:bold;">주</button>
                    </div>
                    <div class="d-flex flex-row-reverse mr-2 calendar-btnAction">
                        <button type="button" class="btn btn-outline-primary btn-sm calendar-btnAction" id="today">Today</button>
                        <button type="button" class="btn btn-outline-secondary btn-sm calendar-btnAction" id="next">다음달</button>
                        <button type="button" class="btn btn-outline-secondary btn-sm calendar-btnAction" id="prev">이전달</button>
                        &nbsp;
                        <!--<button type="button" class="btn btn-outline-secondary btn-sm calendar-btnAction button" id="btn_lvoc" onclick="onclickLvocPop()">퇴근</button>
                        <button type="button" class="btn btn-outline-secondary btn-sm calendar-btnAction button" id="btn_atnd" onclick="onclickStrtTmMain()">출근</button>-->
                    </div>
                </div>

                <!-- 3. 사원 Schedule Grid 영역 -->
                <div id="grp_grid">
                    <div class="p-0">
                        <div class="d-flex justify-content-center" style="height:0; visibility:hidden;">
                            <input type="text" name="date" id="monthpickerData" />
                        </div>
                        <!-- 3-1. 사원 Schedule Grid 영역 주단위 -->
                        <div id="grp_showWeek">
                            <div class="d-flex justify-content-center mb-5">

                                <div>
                                    <img id="btn_weekGridDtDfr" width="20px" height="20px"  src="{% static 'image/arrow_left.png' %}" align="center">
                                </div>
                                <input type="hidden" name="date" id="datepickerData"/>
                                <div id="btn_datepicker" style="margin-right: 10px;margin-left: 10px;">
                                    <h5>
                                        <span id="txt_weekStrtYy"></span>
                                        <span>.</span>
                                        <span id="txt_weekStrtMm"></span>
                                        <span>.</span>
                                        <span id="txt_weekStrtDd"></span>
                                        <span> - </span>
                                        <span id="txt_weekEndYy"></span>
                                        <span>.</span>
                                        <span id="txt_weekEndMm"></span>
                                        <span>.</span>
                                        <span id="txt_weekEndDd"></span>
                                    </h5>
                                </div>
                                <div>
                                    <img id="btn_weekGridDtNxt" width="20px" height="20px"  src="{% static 'image/arrow_right.png' %}" align="center">
                                </div>
                            </div>

                            <!--week table 영역 -->
                            <div id="grid_week"></div>
                        </div>
                        <!-- 3-2. 사원 Schedule Grid 영역 월단위 -->
                        <div id="grp_showMonth">

                            <div class="d-flex justify-content-center mb-5">
                                <div>
                                    <img id="btn_mmGridDtDfr" width="20px" height="20px"  src="{% static 'image/arrow_left.png' %}" align="center">
                                </div>
                                <div id="btn_monthpicker" style="margin-right: 10px;margin-left: 10px;">
                                    <h5>
                                        <span id="txt_mmYy"></span>
                                        <span>.</span>
                                        <span id="txt_mmMm"></span>
                                    </h5>
                                </div>
                                <div>
                                    <img id="btn_mmGridDtNxt" width="20px" height="20px"  src="{% static 'image/arrow_right.png' %}" align="center">
                                </div>
                            </div>
                            <!--week table 영역 -->
                            <div id="month_week"></div>
                        </div>

                    </div>
                </div>
                <!-- 4. 사원 Schedule Calendar 영역 -->
                <div id="grp_calendar">
                    <div>
                        <div id="menu">
                            <span id="menu-navi" class="d-flex justify-content-center mb-2">
                              <span id="calendarLabel" style="font-size: 120%"></span>
                            </span>
                            <span id="renderRange" class="render-range"></span>
                        </div>
                        <div id="calendar" style=" border:1px solid #cccecf;"></div>
                    </div>
                    <span id="trgtDateHidden" style="display:none;"></span>
                </div>
            </div>
        </div>
